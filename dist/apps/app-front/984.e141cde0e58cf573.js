"use strict";(self.webpackChunkapp_front=self.webpackChunkapp_front||[]).push([[984],{5984:(G,g,l)=>{l.r(g),l.d(g,{default:()=>x});var _=l(1635),m=l(177),e=l(4438),r=l(9417),v=l(7183),p=l(4221),C=l(1413);function j(o,a){if(1&o){const n=e.RV6();e.j41(0,"button",7),e.bIt("click",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.cancel())}),e.EFF(1),e.k0s()}if(2&o){const n=e.XpG();e.R7$(),e.SpI(" ",n.cancelText," ")}}let M=(()=>{class o{static#e=this.\u0275fac=function(t){return new(t||o)};static#n=this.\u0275cmp=e.VBU({type:o,selectors:[["app-confirm"]],decls:11,vars:4,consts:[[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"h4",1),e.EFF(2),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){return i.dismiss()}),e.k0s()(),e.j41(4,"div",3)(5,"p"),e.EFF(6),e.k0s()(),e.j41(7,"div",4),e.DNE(8,j,2,1,"button",5),e.j41(9,"button",6),e.bIt("click",function(){return i.confirm()}),e.EFF(10),e.k0s()()),2&t&&(e.R7$(2),e.SpI(" ",i.title," "),e.R7$(4),e.SpI(" ",i.message," "),e.R7$(2),e.Y8G("ngIf",i.cancelText),e.R7$(2),e.SpI(" ",i.confirmText," "))},dependencies:[m.bT]})}return o})(),h=(()=>{class o{#e=(0,e.WQX)(p.Bq);open(n){this.confirmResponseSubject=new C.B,this.confirmResponse$=this.confirmResponseSubject.asObservable();const t=this.#e.open(M);return t.componentInstance.title=n.title,t.componentInstance.message=n.message,t.componentInstance.confirmText=n.confirmText,t.componentInstance.cancelText=n.cancelText,t.dismissed.subscribe(()=>{this.confirmResponseSubject.complete()}),t.componentInstance.confirm=()=>{this.confirmResponseSubject.next(!0),t.close(),this.confirmResponseSubject.complete()},t.componentInstance.cancel=()=>{this.confirmResponseSubject.next(!1),t.close(),this.confirmResponseSubject.complete()},t.componentInstance.dismiss=()=>{t.close(),this.confirmResponseSubject.complete()},this.confirmResponse$}static#n=this.\u0275fac=function(t){return new(t||o)};static#o=this.\u0275prov=e.jDH({token:o,factory:o.\u0275fac})}return o})(),F=(()=>{class o{static#e=this.\u0275fac=function(t){return new(t||o)};static#n=this.\u0275mod=e.$C({type:o});static#o=this.\u0275inj=e.G2t({providers:[h],imports:[m.MD,p.XZ]})}return o})();var S=l(1626),f=l(483);function k(o,a){if(1&o&&e.nrm(0,"ngb-progressbar",11),2&o){const n=e.XpG();e.Y8G("value",n.progressUpload())}}let y=(()=>{class o{constructor(){this.afterSave=new e.bkB,this.afterError=new e.bkB,this.selectedFile=null,this.publicationNumber="",this.publhishedAt="",this.#e=(0,e.WQX)(f.G),this.uploadig=this.#e.select("uploading"),this.progressUpload=this.#e.select("progressUpload")}#e;onFileSelected(n){const{files:t}=n.currentTarget;t&&(this.selectedFile=t[0])}onUpload(){if(!this.selectedFile||!this.publicationNumber||isNaN(Number(this.publicationNumber))||!this.publhishedAt)return void alert("Todos los campos son requeridos");const n=new FormData;n.append("file",this.selectedFile),n.append("publicationNumber",this.publicationNumber),n.append("publhishedAt",this.publhishedAt),this.#e.uploadPdf(n,this.selectedFile.size).subscribe({next:t=>{t?.type===S.hv.Response&&this.afterSave.emit()},error:t=>{this.afterError.emit(t)}})}static#n=this.\u0275fac=function(t){return new(t||o)};static#o=this.\u0275cmp=e.VBU({type:o,selectors:[["app-upload"]],outputs:{afterSave:"afterSave",afterError:"afterError"},standalone:!0,features:[e.aNF],decls:12,vars:4,consts:[[1,"row"],[1,"col-12"],["type","file","accept","application/pdf","aria-label","Seleccionar archivo",1,"form-control",3,"change"],[1,"col-xs-12","col-sm-4","mt-3"],["type","number","placeholder","N\xba Revista","min","1","aria-label","N\xfamero de revista",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-xs-12","col-sm-8","mt-3"],["type","date","placeholder","Fecha de publicaci\xf3n","min","1","aria-label","Fecha de publicaci\xf3n",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","mt-3","d-flex","justify-content-center"],["aria-label","Subir archivo",1,"btn","btn-primary","mt-2",3,"click","disabled"],[1,"col-12","mt-3"],["class","mb-3","type","success",3,"value",4,"ngIf"],["type","success",1,"mb-3",3,"value"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"input",2),e.bIt("change",function(s){return i.onFileSelected(s)}),e.k0s()(),e.j41(3,"div",3)(4,"input",4),e.mxI("ngModelChange",function(s){return e.DH7(i.publicationNumber,s)||(i.publicationNumber=s),s}),e.k0s()(),e.j41(5,"div",5)(6,"input",6),e.mxI("ngModelChange",function(s){return e.DH7(i.publhishedAt,s)||(i.publhishedAt=s),s}),e.k0s()(),e.j41(7,"div",7)(8,"button",8),e.bIt("click",function(){return i.onUpload()}),e.EFF(9," Upload "),e.k0s()(),e.j41(10,"div",9),e.DNE(11,k,1,1,"ngb-progressbar",10),e.k0s()()),2&t&&(e.R7$(4),e.R50("ngModel",i.publicationNumber),e.R7$(2),e.R50("ngModel",i.publhishedAt),e.R7$(2),e.Y8G("disabled",i.uploadig()),e.R7$(3),e.Y8G("ngIf",i.uploadig()))},dependencies:[m.MD,m.bT,r.YN,r.me,r.Q0,r.BC,r.VZ,r.vS,p.Gk,p.EH]})}return o})();var z=l(7951),b=l(9894),R=l(4412),T=l(5558),I=l(6354);const E=(o,a)=>a.id;function N(o,a){if(1&o&&e.nrm(0,"img",18),2&o){const n=e.XpG().$implicit,t=e.XpG();e.Y8G("src",t.mazineImage(n.image),e.B4B)}}function P(o,a){if(1&o){const n=e.RV6();e.j41(0,"tr")(1,"td",13),e.EFF(2),e.k0s(),e.j41(3,"td",13),e.DNE(4,N,1,1,"img",14),e.k0s(),e.j41(5,"td",13),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"td",13),e.EFF(9),e.nI1(10,"date"),e.k0s(),e.j41(11,"td",15)(12,"i",16),e.bIt("click",function(){const i=e.eBV(n).$implicit,c=e.XpG();return e.Njj(c.openPdf(i.path))}),e.k0s(),e.j41(13,"i",17),e.bIt("click",function(){const i=e.eBV(n).$implicit,c=e.XpG();return e.Njj(c.confirmDelete(i))}),e.k0s()()()}if(2&o){const n=a.$implicit;e.R7$(2),e.JRh(n.number),e.R7$(2),e.Y8G("ngIf",n.image),e.R7$(2),e.SpI(" ",e.i5U(7,4,n.publhishedAt,"dd/MM/yyyy")," "),e.R7$(3),e.SpI(" ",e.i5U(10,7,n.createdAt,"dd/MM/yyyy")," ")}}function U(o,a){if(1&o){const n=e.RV6();e.j41(0,"div",19)(1,"h4",20),e.EFF(2,"Subir revista"),e.k0s(),e.j41(3,"button",21),e.bIt("click",function(){const i=e.eBV(n).$implicit;return e.Njj(i.dismiss())}),e.k0s()(),e.j41(4,"div",22)(5,"app-upload",23),e.bIt("afterSave",function(){e.eBV(n);const i=e.XpG();return e.Njj(i.onUploadSuccess())})("afterError",function(i){e.eBV(n);const c=e.XpG();return e.Njj(c.onUploadError(i))}),e.k0s()()}}let d=class u{constructor(){this.collectionSize=0,this.#e=z._.api,this.#n=(0,e.WQX)(p.Bq),this.#o=(0,e.WQX)(f.G),this.#t=new R.t({page:1,pageSize:5,loading:!1}),this.#i=this.#t.asObservable(),this.magazines$=this.#i.pipe((0,b.s)(this),(0,T.n)(a=>this.#o.listMagazines(a.page,a.pageSize).pipe((0,I.T)(n=>(this.collectionSize=n.count,n.rows))))),this.#s=(0,e.WQX)(h)}get page(){return this.#t.value.page}set page(a){this.#t.next({...this.#t.value,page:a})}get pageSize(){return this.#t.value.pageSize}set pageSize(a){this.#t.next({...this.#t.value,pageSize:a})}#e;#n;#o;#t;#i;#a;#s;open(a){this.#a=this.#n.open(a,{ariaLabelledBy:"modal-basic-title"})}mazineImage(a){return a?new URL(a,this.#e).href:""}onUploadSuccess(){this.#a?.close(),this.page=1}onUploadError(a){console.error(a)}openPdf(a){const n=new URL(a,this.#e);window.open(n.href,"_blank")}confirmDelete(a){this.#s.open({title:"Eliminar revista "+a.number,message:"\xbfEst\xe1s seguro de que deseas eliminar la revista y todas sus p\xe1ginas?",confirmText:"Eliminar",cancelText:"Cancelar"}).subscribe(n=>{n&&console.log("delete",a)})}static#l=this.\u0275fac=function(n){return new(n||u)};static#c=this.\u0275cmp=e.VBU({type:u,selectors:[["app-back-office"]],standalone:!0,features:[e.aNF],decls:37,vars:12,consts:[["uploadModal",""],[1,"row","p-4"],[1,"col-12","d-flex","flex-row"],["data-bs-toggle","modal","data-bs-target","#exampleModal","ngbTooltip","Subir revista","placement","right",1,"lni","lni-cloud-upload","fs-1","ms-4",3,"click"],[1,"col-12","mt-3"],[1,"table"],["scope","col"],["scope","col",1,"text-center"],[1,"col-10"],[3,"pageChange","page","pageSize","collectionSize","rotate","boundaryLinks"],[1,"col-2"],["aria-label","Default select example",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"align-middle"],["alt","Portada de la revista","class","img-thumbnail","style","max-width: 100px",3,"src",4,"ngIf"],[1,"text-center","align-middle"],["ngbTooltip","Ver PDF","placement","top",1,"lni","lni-eye","me-3","fs-3",3,"click"],["ngbTooltip","Eliminar","placement","top",1,"lni","lni-trash-can","fs-3",3,"click"],["alt","Portada de la revista",1,"img-thumbnail",2,"max-width","100px",3,"src"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"afterSave","afterError"]],template:function(n,t){if(1&n){const i=e.RV6();e.j41(0,"div",1)(1,"div",2)(2,"h2"),e.EFF(3,"Gestor de revistas"),e.k0s(),e.j41(4,"i",3),e.bIt("click",function(){e.eBV(i);const s=e.sdS(36);return e.Njj(t.open(s))}),e.k0s()(),e.j41(5,"div",4)(6,"table",5)(7,"thead")(8,"tr")(9,"th",6),e.EFF(10,"Revista n\xfamero"),e.k0s(),e.j41(11,"th",6),e.EFF(12,"Portada"),e.k0s(),e.j41(13,"th",6),e.EFF(14,"Publicada"),e.k0s(),e.j41(15,"th",6),e.EFF(16,"Subida"),e.k0s(),e.j41(17,"th",7),e.EFF(18,"Acciones"),e.k0s()()(),e.j41(19,"tbody"),e.Z7z(20,P,14,10,"tr",null,E),e.nI1(22,"async"),e.k0s()()(),e.j41(23,"div",8)(24,"ngb-pagination",9),e.mxI("pageChange",function(s){return e.eBV(i),e.DH7(t.page,s)||(t.page=s),e.Njj(s)}),e.k0s()(),e.j41(25,"div",10)(26,"select",11),e.mxI("ngModelChange",function(s){return e.eBV(i),e.DH7(t.pageSize,s)||(t.pageSize=s),e.Njj(s)}),e.j41(27,"option",12),e.EFF(28,"5"),e.k0s(),e.j41(29,"option",12),e.EFF(30,"10"),e.k0s(),e.j41(31,"option",12),e.EFF(32,"20"),e.k0s(),e.j41(33,"option",12),e.EFF(34,"50"),e.k0s()()()(),e.DNE(35,U,6,0,"ng-template",null,0,e.C5r)}2&n&&(e.R7$(20),e.Dyx(e.bMT(22,10,t.magazines$)),e.R7$(4),e.R50("page",t.page),e.Y8G("pageSize",t.pageSize)("collectionSize",t.collectionSize)("rotate",!0)("boundaryLinks",!0),e.R7$(2),e.R50("ngModel",t.pageSize),e.R7$(),e.Y8G("value",5),e.R7$(2),e.Y8G("value",10),e.R7$(2),e.Y8G("value",20),e.R7$(2),e.Y8G("value",50))},dependencies:[m.MD,m.bT,m.Jj,m.vh,y,F,r.YN,r.xH,r.y7,r.wz,r.BC,r.vS,v.q,p.n8,p.md,p.c9,p.s5],styles:["[_nghost-%COMP%]   ngb-progressbar[_ngcontent-%COMP%]{position:fixed;top:1px;left:0;width:100vw;z-index:1056}[_nghost-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}[_nghost-%COMP%]   i.lni-cloud-upload[_ngcontent-%COMP%]{color:#556b2f}[_nghost-%COMP%]   i.lni-cloud-upload[_ngcontent-%COMP%]:hover{color:#405123}[_nghost-%COMP%]   i.lni-trash-can[_ngcontent-%COMP%]{color:#8b0000}[_nghost-%COMP%]   i.lni-trash-can[_ngcontent-%COMP%]:hover{color:#5a1f1f}[_nghost-%COMP%]   i.lni-eye[_ngcontent-%COMP%]{color:#00008b}[_nghost-%COMP%]   i.lni-eye[_ngcontent-%COMP%]:hover{color:#1f1f5a}[_nghost-%COMP%]   i.lni-pencil[_ngcontent-%COMP%]{color:#556b2f}[_nghost-%COMP%]   i.lni-pencil[_ngcontent-%COMP%]:hover{color:#405123}"]})};d=(0,_.Cg)([(0,b.d)()],d);const x=d}}]);