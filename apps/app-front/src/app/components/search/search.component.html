<form class="row p-sm-0 pe-5" [formGroup]="search">
  <div class="col-12 p-0">
    <div class="input-group w-100">
      <input
        type="text"
        class="form-control form-control-lg"
        [placeholder]="'search.placeholder' | transloco"
        formControlName="query"
        [attr.aria-label]="'search.searchInMagazines' | transloco"
      />
      <span class="input-group-text button-clean" (click)="cleanQuery()">
        <i
          class="lni lni-close"
          [ngbTooltip]="'search.clearSearch' | transloco"
          placement="left"
          [attr.aria-label]="'search.clearSearch' | transloco"
        ></i>
      </span>
    </div>
  </div>
  <div class="col-12 search-filters p-0">
    <div
      ngbAccordion
      (hidden)="filtersOpen = false"
      (show)="filtersOpen = true"
    >
      <div ngbAccordionItem>
        <div
          ngbAccordionHeader
          class="text-end"
          [attr.aria-label]="'search.advancedFilters' | transloco"
        >
          <button ngbAccordionButton>
            {{
              !filtersOpen
                ? ('search.advancedFilters' | transloco)
                : ('search.hideFilters' | transloco)
            }}
            <span class="filter-alert">{{
              !filtersOpen && search.value.number && search.value.type
                ? ' ' + ('search.activeFilters' | transloco) + '.'
                : ''
            }}</span>
          </button>
        </div>
        <div ngbAccordionCollapse>
          <div ngbAccordionBody>
            <ng-template>
              <div class="row">
                <label for="inputRevista" class="col-sm-6 col-form-label">{{
                  'search.filterByMagazine' | transloco
                }}</label>
                <div class="col-sm-3">
                  <select
                    class="form-select"
                    [attr.aria-label]="'search.filterType' | transloco"
                    formControlName="type"
                  >
                    <option value="">
                      {{ 'search.selectType' | transloco }}
                    </option>
                    @for(type of typeOptions; track $index){
                    <option [value]="type">
                      {{ typeDescription[$index] | transloco }}
                    </option>
                    }
                  </select>
                </div>

                <div class="col-2">
                  <input
                    type="number"
                    class="form-control"
                    id="inputRevista"
                    [placeholder]="
                      'search.magazineNumberPlaceholder' | transloco
                    "
                    formControlName="number"
                  />
                </div>
                <div class="col-1">
                  <button class="btn btn-primary" (click)="searchByFilters()">
                    {{ 'search.applyFilters' | transloco }}
                  </button>
                </div>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
