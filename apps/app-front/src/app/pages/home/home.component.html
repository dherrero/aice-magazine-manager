<section class="searcher d-flex flex-column align-items-center m-2">
  <form
    class="row w-100 d-flex align-items-center justify-content-center"
    [formGroup]="search"
  >
    <div class="col-12">
      <div class="row p-0">
        <div class="col-12 p-0">
          <input
            type="text"
            class="form-control-lg w-100"
            placeholder="Escribe aquí para empezar a buscar..."
            formControlName="query"
          />
        </div>
        <div
          class="input-clean"
          (click)="cleanQuery()"
          title="limpiar"
          ngbTooltip="limpiar"
          placement="left"
        >
          <i class="lni lni-close"></i>
        </div>
      </div>
    </div>
    <div class="col-12 search-ations">
      <div class="row">
        <div class="col-1">
          <button
            class="btn btn-lg fit-content"
            (click)="open(content)"
            title="subir revista"
            ngbTooltip="Subir revista"
            placement="bottom"
          >
            <i class="lni lni-plus"></i>
          </button>
        </div>
      </div>
    </div>
  </form>
</section>
<hr />
<section class="results row h-90">
  @if (magazineService.loading()){
  <div
    class="col-12 d-flex flex-colum align-items-center justify-content-center loading"
  >
    <div class="spinner-border text-warning-emphasis" role="status">
      <span class="sr-only">Buscando...</span>
    </div>
  </div>
  } @else {
  <div class="col-12 row d-flex flex-wrap">
    @for (result of magazineService.results(); track $index) {
    <app-card
      class="col-xs-12 col-sm-6 col-md-4 mb-2"
      [title]="
        'Revista nº ' + result.Magazine.number + ' página ' + result.number
      "
      [content]="
        result.content | highlightQuery : search.get('query')?.value ?? ''
      "
      [pdfPath]="result.Magazine.path"
      [page]="result.number"
      [frontPage]="result.Magazine.image"
    ></app-card>
    }
  </div>
  }
</section>

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Subir revista</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <app-upload [afterSave]="modal.close"></app-upload>
  </div>
</ng-template>
